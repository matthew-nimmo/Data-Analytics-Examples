---
format: html-eval-false
---

::: {.content-visible when-format="html-eval-false"}
```{r}
#| echo: false
#| output: false
library(targets)

source("src/exploratory-analysis/sum_stats.R")
source("src/exploratory-analysis/digits.R")
```
:::

# Data

All sample data were provided in a single comma delimited (CSV) file. The data set contains assays for cadmium (Cd ppm), cobalt (Co ppm), chromium (Cr ppm), copper (Cu %), nickel (Ni ppm), lead (Pb ppm) and zinc (Zn ppm).

Automatic data type identification was utilized during importing of the nodule sample data from comma delimited and Microsoft Excel files. Conversion of the assay values results in values at or below or above detection limit (values prefixed with < or >) are set to detection limit (leading < or > are automatically removed). This is the preferred behavior as values less than or above detection limit are censored data and it is not known by how much the value is below or above the detection limit. To avoid bias it is better to set the values to detection limit.

```{targets o_jura}
#| label: o_jura
#| tar_simple: true
#| tar_interactive: false
#| output: false

data(jura)
rbind(jura.pred, jura.val)
```

```{targets a_jura}
#| label: a_jura
#| tar_simple: true
#| tar_interactive: false
#| output: false

x <- o_jura

# Add missing values

x$Landuse[sample.int(nrow(x), 17)] <- NA
x$Rock[sample.int(nrow(x), 4)] <- NA
x$Rock[x$Rock == "Quaternary" & x$Co < 3] <- NA
x$Cd[sample.int(nrow(x), 10)] <- NA
x$Cu[sample.int(nrow(x), 23)] <- NA
x$Cr[x$Ni > 34] <- NA
x$Co[x$Ni < 4.7] <- NA
x$Zn[x$Ni < 4.7] <- NA
x$Pb[x$Ni < 4.7] <- NA
x$Ni[x$Ni < 4.7] <- NA

x
```

Build the data and then load `a_titanic` data frame into memory.

```{r}
#| output: false
#| message: false
#| error: false
if (length(tar_outdated()) > 0) {
  tar_make()
}
tar_load(a_jura)
```

```{r}
summary(a_jura)
```

The sample data provided by Kings Landing include `r nrow(jura)` samples. The sampling and assaying method is not known. Summary statistics of the primary assays are listed in Table \@ref(tab:ah-sumstat).

```{r }
#| label: tbl-stats

Filter(is.numeric, a_jura) |>
  sapply(FUN=sum_stats, simplify="data.frame") |>
  t() |>
  knitr::kable(digits=2)
```

---
format: html-eval-false
---

# Domaining

> Describe process of defining/interpreting geological domains.

No geological interpretation was performed.

Geological domains are defined by rock stratigraphy (age) and include Sequanian (SEQ), Kimmeridgian (KIM), Quaternary (QUA), Argovian (ARG) and Portlandian (POR).

Within the boundary of the Jura deposit no areas were excluded from the resource estimate.

```{r}
M__IND <- cache_data("./data/M/M__jura_rock_ind.rds", function() {
  gr <- raster(ncols=54, nrows=66, xmn=0, xmx=5.4, ymn=0, ymx=6.4)

  x <- B__AH
  x <- x[complete.cases(x), ]
  coordinates(x) <- ~ X + Y
  z <- as.data.frame(coordinates(gr))
  names(z) <- c("X","Y")
  coordinates(z) <- ~ X + Y

  set.seed(9)
  flds <- c("SEQ","KIM","QUA","ARG","POR")
  y <- lapply(flds, function(i) {
    z <- krige(as.formula(paste(i, "~ 1")), x, newdata=z, nsim=0,
              model=vgm(0.3, "Sph", 1.5, add.to=vgm(0.6, "Sph", 0.5, 0.1)),
              maxdist=3, nmin=1, nmax=10, omax=3)
    z@data$var1.pred[is.na(z@data$var1.pred)] <- 0
    z@data$var1.pred <- pmax(0, pmin(1, z@data$var1.pred))
    raster(SpatialPixelsDataFrame(z@coords, z@data))
  })
  y <- brick(y)
  names(y) <- flds
  y <- rasterize(jura_bnd, y, mask=TRUE)

  return(y)
}, out.csv=FALSE)
```

A geological raster model was constructed by kriging the dummy lithology variables SEQ, KIM, QUA, ARG and POR. The raster origin was set at 0 UTM X and 0 UTM Y coordinates. Cell dimensions of 20m by 20mm was used resulting in a raster with 54 cells in the X and 66 cells in the Y for a total of 3564 cells. A single lithology layer was constructed by taking the maximum probability across the estimated indicators for each cell and the cell value set to the column name that corresponds to the maximum value.

Figure \@ref(fig:ind-ok) shows the indicator maps for each lithology while Figure \@ref(fig:ind-rock) is the constructed lithology map derived from the indicator maps.

```{r ind-ok, fig.width=9, fig.height=6, fig.cap="Lithology indicator maps created using Indicator Kriging."}
par(oma=c(1,1,1,1))
plot(M__IND, asp=1, col=viridis(20),
     addfun=function() {
       #points(B__AH$X, B__AH$Y, pch="+", col="white")
       box(col="white")
       lines(jura_bnd, col="red", lwd=2)
})
```
